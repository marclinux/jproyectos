<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8">
  <title>Actualizar Actividad</title>
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-gray-100 text-gray-800">
  <div class="max-w-3xl mx-auto mt-10 bg-white p-8 shadow-md rounded-lg">
    <form action="#" th:action="@{/scrum/actividades/actualizar/{id}(id=${actividad.id})}" th:object="${actividad}" method="post" class="space-y-6">
      
      <div th:switch="${historias}">
        <h2 th:case="null" class="text-xl font-semibold text-red-600">Debe registrar Historias</h2>
        
		<div th:case="*">
          <label for="historia" class="block text-sm font-medium text-gray-700 mb-1">Historia</label>
          <select th:field="*{history.id}" id="historia" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
            <option th:each="historia : ${historias}" th:value="${historia.id}" th:text="${historia.id}"></option>
          </select>
        </div>
		
        <span th:errors="*{history}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="descripcion" class="block text-sm font-medium mb-1">Descripción</label>
        <input type="text" th:field="*{descripcion}" id="descripcion" placeholder="Descripción de la Actividad"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('descripcion')}" th:errors="*{descripcion}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="fechaInicio" class="block text-sm font-medium mb-1">Fecha de Inicio</label>
        <input type="date" th:field="*{fechaInicio}" id="fechaInicio"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('fechaInicio')}" th:errors="*{fechaInicio}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="horaInicio" class="block text-sm font-medium mb-1">Hora de Inicio</label>
        <input type="time" th:field="*{horaInicio}" id="horaInicio" placeholder="Hora de Inicio"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('horaInicio')}" th:errors="*{horaInicio}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="fechaFinal" class="block text-sm font-medium mb-1">Fecha de Término</label>
        <input type="date" th:field="*{fechaFinal}" id="fechaFinal" onchange="calcular()"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('fechaFinal')}" th:errors="*{fechaFinal}" class="text-sm text-red-600"></span>
        <span th:if="${errorMessage}" th:text="${errorMessage}" id="spanError" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="horaFinal" class="block text-sm font-medium mb-1">Hora Final</label>
        <input type="time" th:field="*{horaFinal}" id="horaFinal" placeholder="Hora Final"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('horaFinal')}" th:errors="*{horaFinal}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="interrupcion" class="block text-sm font-medium mb-1">Interrupción</label>
        <input type="text" th:field="*{interrupcion}" id="interrupcion" placeholder="Tiempo de Interrupción"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('interrupcion')}" th:errors="*{interrupcion}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="etapa" class="block text-sm font-medium mb-1">Etapa del Desarrollo</label>
        <select th:field="*{etapa}" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
          <option th:value="'1'">Planeación</option>
          <option th:value="'2'">Diseño</option>
          <option th:value="'3'">Revisión de Diseño</option>
          <option th:value="'4'">Codificación</option>
          <option th:value="'5'">Revisión de Codificación</option>
          <option th:value="'6'">Compilación</option>
          <option th:value="'7'">Pruebas Unitarias</option>
          <option th:value="'8'">postmortem</option>
        </select>
        <span th:if="${#fields.hasErrors('etapa')}" th:errors="*{etapa}" class="text-sm text-red-600"></span>
      </div>

      <div>
        <label for="artefactos" class="block text-sm font-medium mb-1">Artefactos</label>
        <input type="text" th:field="*{artefactos}" id="artefactos" placeholder="Entidades, páginas HTML"
          class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-blue-500">
        <span th:if="${#fields.hasErrors('artefactos')}" th:errors="*{artefactos}" class="text-sm text-red-600"></span>
      </div>

      <div class="flex gap-4">
        <input type="submit" value="Actualizar"
          class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded">
        <a href="../index" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-4 rounded">Cancelar</a>
      </div>
    </form>
  </div>
</body>

</html>
